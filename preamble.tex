%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% pre4.tex -- LaTeX Preamble               %
%                                          %
% Author: Mathias Dannesbo <neic@neic.dk>  %
% Time-stamp: <2016-01-12 18:43:35 (neic)> %
%                                          %
% XeLaTeX/LuaLaTeX preamble with modern    %
% packages.                                %
%                                          %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% The special requirements for this to work is:
% - the serif fontface Arno Pro from Adobe,
% - the sans serif fontface Gill Sans,
% - the math fontface Cambria Math from Microsoft and
% - python with
% - Pygments.
% The TeX-engine should also be run with -shell-escape.

%\includeonly{resultsdiscussion}

\RequirePackage[l2tabu, orthodox]{nag}
%\listfiles
\documentclass[a4paper,12pt,twoside,article,table,english,final]{memoir}[2015/07/08]

%%%%%%%%%%%%%%%%
%%% Geometry %%%
%%%%%%%%%%%%%%%%

%\isopage[12]

% Bringhurst 2.4.8 Never begin a page with the last line of a
% multi-line paragraph. Memoir 3.5 Sloppybottom.
\setlength{\topskip}{1.6\topskip} %memoir
\checkandfixthelayout %memoir
\sloppybottom %memoir

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Fonts and misc. typography %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{fontspec,subfig}
\setmainfont{Arno Pro}[Ligatures=TeX,Numbers=OldStyle] % fontspec
\setsansfont{Gill Sans}[Scale=MatchLowercase] % fontspec

% Use \lining to get lining numbers in a scope. Use \swash to get
% swash style in a scope.
\newcommand{\lining}{\addfontfeature{Numbers=Lining}}  % fontspec
\newfontface\swash[Ligatures=TeX,Numbers=OldStyle,Style=Swash]{Arno Pro Italic}

% Use \abbr with uppercase instead of \textsc with lowercase for abbreviations.
% E.g. \abbr{NATO} instead of \textsc{nato}. This makes the copyable text
% uppercase and also works in headings when hyperref or bookmark generates a pdf
% bookmark tree. TODO: Add Bringhurst ref.
\newcommand{\abbr}[1]{\texorpdfstring{
    {\addfontfeature{Letters=UppercaseSmallCaps}#1}}{#1}} % hyperref, fontspec

% Bringhurst 4.3.3 [Notes:] Use superscripts in the text but full-size
% numbers in the notes themselves. Memoir 12.1.2 [Footnotes:] Styling.
\setlength{\footmarkwidth}{-1sp} %memoir
\setlength{\footmarksep}{0em} %memoir
\footmarkstyle{#1 } %memoir

% Use the same footmarkstyle with threeparttable
\usepackage[online]{threeparttable}
\usepackage{etoolbox}
\appto\TPTnoteSettings{\footnotesize} %threeparttable (req. etoolbox)

% Use sans-serif for captions
% TODO: Få det til at virke med \textsc{}
\captionnamefont{\sffamily}
\captiontitlefont{\sffamily}


%%%%%%%%%%%%%%%%%%%%
%%% Localization %%%
%%%%%%%%%%%%%%%%%%%%

% Bringhurst 2.4.1 At hyphenated line-ends, leave at least two
% characters behind and take at least three forward.
% Bringhurst 2.4.5 Hypenate according to the conventions of the
% language.
\usepackage{polyglossia}
\setdefaultlanguage{english} %polyglossia

% Use microtype
\usepackage{microtype}
\microtypesetup{final,verbose=silent} %microtype

\maxtocdepth{subsection}

%%%%%%%%%%%%%%%%%%
%%% Math setup %%%
%%%%%%%%%%%%%%%%%%

\usepackage{amsmath,unicode-math,mathtools}
\unimathsetup{math-style=ISO,bold-style=ISO} % unicode-math

\setmathfont{Cambria Math}[Scale=MatchLowercase,vargreek-shape=unicode] % unicode-math

\setmathfont{Arno Pro}[range={up/{num,latin,Latin,greek,Greek},
  \question,\exclam,\mathdollar,%
  \percent,\ampersand,\plus,\comma,\period,\mathslash,\mathcolon,%
  \semicolon,\less,\equal,\greater,\backslash,\atsign,\vert,%
  \times,\lbrace,\rbrace,\div}] % unicode-math. Missing \lbrack, \rbrack
\setmathfont{Arno Pro Italic}[range={it/{num,latin,Latin,greek,Greek}}]
\setmathfont{Arno Pro Bold}[range = {bfup/{num,latin,Latin,greek,Greek}}]
\setmathfont{Arno Pro Bold Italic}[range={bfit/{num,latin,Latin,greek,Greek}}]


\setmathfont{Gill Sans Std}[Scale=MatchLowercase,range={sfup/{num,latin,Latin,greek,Greek}}]
\setmathfont{Gill Sans Std Italic}[Scale=MatchLowercase,range={sfit/{num,latin,Latin,greek,Greek}}]

\setmathfont{Gill Sans Std Bold}[Scale=MatchLowercase,range={bfsfup/{num,latin,Latin,greek,Greek}}]
\setmathfont{Gill Sans Std Bold Italic}[Scale=MatchLowercase,range={bfsfit/{num,latin,Latin,greek,Greek}}]

\setmathfont{Arno Pro Italic}[range={cal,bfcal}, RawFeature={+swsh}]

%\setmathfont{Arno Pro}[range=tt->up]

%\else
%   \setmathfont[Scale=MatchLowercase]{Cambria Math} % unicode-math
% \fi


\usepackage[mode = text,
text-angstrom = {Å},
math-angstrom = {Å},
]{siunitx}

%%%%%%%%%%%%%%
%%% Colors %%%
%%%%%%%%%%%%%%
% TODO
\usepackage{xcolor}
\definecolor{shadecolor}{gray}{0.9}

% Tableau 20 color palette
\definecolor{tblue}{RGB}{31,119,180}    \definecolor{tlightblue}{RGB}{174,199,232}
\definecolor{torange}{RGB}{255,127,14}  \definecolor{tlightorange}{RGB}{255,187,120}
\definecolor{tgreen}{RGB}{44,160,44}    \definecolor{tlightgreen}{RGB}{152,223,138}
\definecolor{tred}{RGB}{214,39,40}      \definecolor{tlightred}{RGB}{255,152,150}
\definecolor{tpurple}{RGB}{148,103,189} \definecolor{tlightpurple}{RGB}{197,176,213}
\definecolor{tbrown}{RGB}{140,86,75}    \definecolor{tlightbrown}{RGB}{196,156,148}
\definecolor{tpink}{RGB}{227,119,194}   \definecolor{tlightpink}{RGB}{247,182,210}
\definecolor{tgray}{RGB}{127,127,127}   \definecolor{tlightgray}{RGB}{199,199,199}
\definecolor{tolive}{RGB}{188,189,34}   \definecolor{tlightolive}{RGB}{219,219,141}
\definecolor{tteal}{RGB}{23,190,207}    \definecolor{tlightteal}{RGB}{158,218,229}


% TODO
\DeclarePairedDelimiterX\Set[2]{\lbrace}{\rbrace}{#1\,\delimsize\vert\, #2}

%%%%%%%%%%%%%%%%%%%%
%%% TÅGEKAMMERET %%%
%%%%%%%%%%%%%%%%%%%%

%\usepackage{tket}
%\TKsetup{C = {\kern-0.1ex\scalebox{0.94}{\raisebox{-0.08ex}{\ensuremath{ℂ}}}}} % med Arno Pro og TeX Gyre Pagella math
%\newfontface\bbface[Scale=0.87]{TeX Gyre Termes Math} \TKsetup{C = {\bbface\kern-0.1exℂ}} % fontspec,tket
%\TKsetup{dollar={\$}} % tket
% lining KA$$


%%%%%%%%%%%%%%%%%
%%% Titlepage %%%
%%%%%%%%%%%%%%%%%
% TODO
\setlength{\droptitle}{-3em}
\pretitle{\LARGE\par} \posttitle{\vskip 0.5em}
\newcommand{\supertitle}[1]{\gdef\suP{#1}}
\renewcommand{\maketitlehooka}{\ifx\suP\undefined\begin{center}\else\begin{center} {\scshape\suP}\fi}
    \newcommand{\subtitle}[1]{\gdef\suB{#1}}
    \renewcommand{\maketitlehookb}{\ifx\suB\undefined \end{center}\else\par {\large\scshape\suB}\par\end{center}\fi}

%%%%%%%%%%%%%%
%%% Header %%%
%%%%%%%%%%%%%%
% TODO
\newcommand{\stunum}[1]{\gdef\stuN{#1}}
\copypagestyle{articlehead}{plain}
\makeoddhead{articlehead}{\color{gray}\suB}{}{\color{gray}\thedate}
\pagestyle{articlehead}

%%%%%%%%%%%%%%%
%%% Grapics %%%
%%%%%%%%%%%%%%%
% TODO
\usepackage{tikz,rotating,pgfplots}
%\usetikzlibrary{external}
%\tikzexternalize[prefix=tikz/]
\pgfplotsset{compat=1.12}

\pgfplotscreateplotcyclelist{tcolor}{%
    {solid, color=tblue},
    {solid, color=torange},
    {solid, color=tgreen},
    {solid, color=tred},
    {solid, color=tpurple},
    {solid, color=tbrown},
    {solid, color=tpink},
    {solid, color=tgray},
    {solid, color=tolive},
    {solid, color=tteal},
}

%%%%%%%%%%%%%%
%%% resten %%%
%%%%%%%%%%%%%%
% TODO
\usepackage{pdfpages,mhchem,xspace}

% \usepackage{minted} % requires minted > 2.0-alpha2
% \usemintedstyle{tango}

\usepackage{ragged2e}
\usepackage{csquotes}

%%%%%%%%%%%%
%%% Help %%%
%%%%%%%%%%%%
% TODO
%\usepackage{lipsum}
\usepackage[margin,draft]{fixme} \fxusetheme{color}

%%%%%%%%%%%%%%%%%%%%
%%% Bibliography %%%
%%%%%%%%%%%%%%%%%%%%
\usepackage[
  backend=biber,
  sortlocale=auto,
  sortcites=true,
  hyperref=true,
  maxbibnames=99,
  style=numeric,
  sorting=none,
]{biblatex}
\addbibresource{literatur.bib}

%%%%%%%%%%%%%%%%%%
%%% References %%%
%%%%%%%%%%%%%%%%%%
% TODO
% varioref, hyperref and cleverref need to be loaded in this order
\usepackage{varioref}
\usepackage[unicode=true,
    pdfusetitle,
    pdfkeywords={},
    pdfdisplaydoctitle=true,
    ]{hyperref}
\usepackage{cleveref}




\begin{document}
%%%%%%%%%%%%%%%%%%%
%%% Frontmatter %%%
%%%%%%%%%%%%%%%%%%%
\frontmatter
%\thispagestyle{empty}
\supertitle{}
\title{A title}
\subtitle{}
\author{An-Author}
\stunum{12345678}
\date{\today}
\maketitle

\clearpage
%\include{acknowledgements}
%\include{abstract}
%\include{abbreviations}

\tableofcontents

%%%%%%%%%%%%%%%%%%
%%% Mainmatter %%%
%%%%%%%%%%%%%%%%%%
\mainmatter
\include{test/typography}
%\include{introduction}
%\include{materialmethods}
%\include{resultsdiscussion}
%\include{conclusion}

\raggedright
\defbibheading{chapter}[\refname]{\chapter*{#1}\addcontentsline{toc}{chapter}{\refname}}
\printbibliography[heading=chapter]

\clearpage \appendix
%\include{appendix/consetrationcalculations}
%\include{appendix/additionalmeasurements}

%%%%%%%%%%%%%%%%%%
%%% Backmatter %%%
%%%%%%%%%%%%%%%%%%
\clearpage
\backmatter
%\listoftables
\listoffigures
% \listoflistings

\end{document}

%%% Local Variables:
%%% coding: utf-8
%%% mode: latex
%%% End: